<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#222">
<title>KoÃ§ v2</title>
<style>
    body { font-family: sans-serif; background-color: #222; color: #eee; margin: 0; padding: 5px; padding-bottom: 60px; }
    h1 { font-size: 18px; text-align: center; color: #ff9900; margin-bottom: 10px; }
    
    /* MenÃ¼ Navigasyon */
    .nav-bar { position: fixed; bottom: 0; left: 0; width: 100%; background: #444; border-top: 1px solid #666; height: 50px; display: flex; }
    .nav-btn { flex: 1; background: none; border: none; color: #aaa; font-size: 12px; font-weight: bold; }
    .active-nav { color: #ff9900; background: #333; }

    .content { display: none; padding: 5px; margin-bottom: 20px; }
    .show { display: block; }

    /* Kartlar */
    .card { background: #333; padding: 10px; border-radius: 5px; margin-bottom: 10px; border: 1px solid #444; }
    .item { border-bottom: 1px solid #555; padding: 8px 0; font-size: 14px; }
    .check-box { display: inline-block; width: 20px; height: 20px; background: #eee; margin-right: 10px; vertical-align: middle; border-radius: 3px; }
    .checked { background: #00cc00; }
    
    .btn-action { width: 100%; padding: 12px; background: #006600; color: white; border: none; border-radius: 5px; font-size: 16px; margin-top: 5px; }
    .malzeme-detay { color: #999; font-size: 11px; display: block; margin-left: 30px; margin-top: 2px; }
    
    /* GeÃ§miÅŸ Listesi */
    .history-item { background: #444; padding: 10px; margin-bottom: 5px; border-radius: 3px; font-size: 12px; }
    .history-date { color: #ff9900; font-weight: bold; border-bottom: 1px solid #666; display: block; margin-bottom: 5px; }

    /* Bildirim Butonu */
    #notifBtn { background: #004488; margin-bottom: 10px; font-size: 12px; padding: 8px; }
</style>
</head>
<body>

<h1>KOÃ‡UM v2.0</h1>

<div id="sayfa-diyet" class="content show">
    <button id="notifBtn" onclick="bildirimIzniIste()" class="btn-action">ðŸ”” Bildirimleri AÃ§ (Modern Telefonlar)</button>
    <div class="card">
        <div style="text-align:right; font-size:11px; color:#888" id="tarihGostergesi"></div>
        <div id="gunlukMenu"></div>
    </div>
    <button onclick="gunuBitir()" class="btn-action" style="background:#cc0000;">GÃ¼nÃ¼ Bitir & Kaydet</button>
</div>

<div id="sayfa-spor" class="content">
    <h3>Antrenman</h3>
    <div class="card" id="antrenmanListesi"></div>
</div>

<div id="sayfa-market" class="content">
    <h3>Malzemeler</h3>
    <div class="card" id="alisverisListesi"></div>
</div>

<div id="sayfa-gecmis" class="content">
    <h3>GeÃ§miÅŸ KayÄ±tlar</h3>
    <button onclick="gecmisiTemizle()" style="background:#444; color:#fff; border:1px solid #666; width:100%; padding:5px;">GeÃ§miÅŸi Sil</button>
    <div id="gecmisListesi" style="margin-top:10px;"></div>
</div>

<div class="nav-bar">
    <button class="nav-btn active-nav" onclick="nav('diyet', this)">DÄ°YET</button>
    <button class="nav-btn" onclick="nav('spor', this)">SPOR</button>
    <button class="nav-btn" onclick="nav('market', this)">MARKET</button>
    <button class="nav-btn" onclick="nav('gecmis', this)">GEÃ‡MÄ°Åž</button>
</div>

<script>
    // --- VERÄ°LER ---
    var kahvaltilar = [
        { ad: "2 Yumurta + Peynir", malz: "2 Yumurta, Peynir, Zeytin, YeÅŸillik" },
        { ad: "Yulaf LapasÄ±", malz: "YoÄŸurt, Yulaf, Elma, TarÃ§Ä±n" },
        { ad: "Menemen", malz: "Yumurta, Domates, Biber, 1 Ekmek" },
        { ad: "HaÅŸlanmÄ±ÅŸ Yumurta SalatasÄ±", malz: "2 Yumurta, Marul, Limon, Pulbiber" }
    ];
    var ogleler = [
        { ad: "Tavuklu Bulgur", malz: "150gr Tavuk, 4 kaÅŸÄ±k Bulgur, Salata" },
        { ad: "Kuru Fasulye & YoÄŸurt", malz: "Kuru Fasulye, YoÄŸurt (Ekmek yok)" },
        { ad: "Ton BalÄ±klÄ± Salata", malz: "Ton balÄ±ÄŸÄ±, GÃ¶bek marul, MÄ±sÄ±r yok" }
    ];
    var ikindiler = [
        { ad: "SÃ¼tlÃ¼ Kahve & Badem", malz: "SÃ¼t, TÃ¼rk Kahvesi, 10 Badem" },
        { ad: "Meyve & Kefir", malz: "1 Elma/Muz, Sade Kefir" },
        { ad: "Leblebi & YeÅŸil Ã‡ay", malz: "SarÄ± Leblebi, YeÅŸil Ã‡ay" }
    ];
    var aksamlar = [
        { ad: "Sebze YemeÄŸi (Ekmeksiz)", malz: "Ispanak/PÄ±rasa vb., YoÄŸurt" },
        { ad: "Ã‡orba & Salata", malz: "Mercimek Ã‡orbasÄ±, Peynirli Salata" },
        { ad: "Izgara KÃ¶fte", malz: "KÃ¶fte, KÃ¶z Biber, Roka" }
    ];
    
    var egzersizler = [
        {name: "Oturarak Omuz Press", set: "3x12"},
        {name: "DambÄ±l KÃ¼rek", set: "3x12"},
        {name: "Yerde GÃ¶ÄŸÃ¼s Press", set: "3x15"},
        {name: "KÃ¶prÃ¼ (KalÃ§a)", set: "3x15"},
        {name: "YavaÅŸ Squat (Koltuk)", set: "3x10"},
        {name: "YÃ¼rÃ¼yÃ¼ÅŸ", set: "30 Dk"}
    ];

    // --- SÄ°STEM ---
    var aktifPlan = {};

    function nav(sayfa, btn) {
        var contents = document.getElementsByClassName("content");
        for(var i=0; i<contents.length; i++) contents[i].style.display = "none";
        document.getElementById("sayfa-"+sayfa).style.display = "block";
        
        var btns = document.getElementsByClassName("nav-btn");
        for(var i=0; i<btns.length; i++) btns[i].className = "nav-btn";
        btn.className += " active-nav";
        
        if(sayfa === 'gecmis') gecmisiGetir();
    }

    function rastgele(dizi) { return dizi[Math.floor(Math.random() * dizi.length)]; }

    function planOlustur() {
        var bugun = new Date().toDateString();
        // EÄŸer bugÃ¼n zaten plan varsa onu yÃ¼kle, yoksa yeni oluÅŸtur
        if(localStorage.getItem("aktifTarih") === bugun && localStorage.getItem("aktifPlan")) {
            aktifPlan = JSON.parse(localStorage.getItem("aktifPlan"));
        } else {
            aktifPlan = {
                k: rastgele(kahvaltilar),
                o: rastgele(ogleler),
                i: rastgele(ikindiler),
                a: rastgele(aksamlar),
                tarih: new Date().toLocaleDateString()
            };
            localStorage.setItem("aktifPlan", JSON.stringify(aktifPlan));
            localStorage.setItem("aktifTarih", bugun);
        }
        arayuzuDoldur();
    }

    function arayuzuDoldur() {
        document.getElementById("tarihGostergesi").innerText = aktifPlan.tarih;
        
        var html = "";
        html += kartYarat("KAHVALTI", aktifPlan.k.ad);
        html += kartYarat("Ã–ÄžLE", aktifPlan.o.ad);
        html += kartYarat("Ä°KÄ°NDÄ°", aktifPlan.i.ad);
        html += kartYarat("AKÅžAM", aktifPlan.a.ad);
        document.getElementById("gunlukMenu").innerHTML = html;

        var marketHtml = "";
        marketHtml += listeYarat(aktifPlan.k.malz);
        marketHtml += listeYarat(aktifPlan.o.malz);
        marketHtml += listeYarat(aktifPlan.i.malz);
        marketHtml += listeYarat(aktifPlan.a.malz);
        document.getElementById("alisverisListesi").innerHTML = marketHtml;
        
        sporListesiYarat();
    }

    function kartYarat(baslik, icerik) {
        return "<div class='item' onclick='check(this)'><span class='check-box'></span><b>"+baslik+":</b> "+icerik+"</div>";
    }
    
    function listeYarat(icerik) {
        return "<div class='item' onclick='check(this)'><span class='check-box'></span>"+icerik+"</div>";
    }

    function sporListesiYarat() {
        var html = "";
        for(var i=0; i<egzersizler.length; i++) {
            html += "<div class='item' onclick='check(this)'><span class='check-box'></span><b>"+egzersizler[i].name+"</b> ("+egzersizler[i].set+")</div>";
        }
        document.getElementById("antrenmanListesi").innerHTML = html;
    }

    function check(el) {
        var box = el.getElementsByClassName("check-box")[0];
        if(box.className.indexOf("checked") == -1) {
            box.className += " checked";
            el.style.opacity = "0.5";
        } else {
            box.className = box.className.replace(" checked", "");
            el.style.opacity = "1";
        }
    }

    // --- GEÃ‡MÄ°Åž VE TAKÄ°P ---
    function gunuBitir() {
        if(!confirm("BugÃ¼nÃ¼ tamamladÄ±n mÄ±? KayÄ±t altÄ±na alÄ±nÄ±p yarÄ±n iÃ§in yeni plan yapÄ±lacak.")) return;
        
        var gecmis = JSON.parse(localStorage.getItem("diyetGecmisi") || "[]");
        gecmis.unshift({ // BaÅŸa ekle
            tarih: aktifPlan.tarih,
            ozet: aktifPlan.k.ad + ", " + aktifPlan.a.ad
        });
        
        localStorage.setItem("diyetGecmisi", JSON.stringify(gecmis));
        
        // YarÄ±n iÃ§in tarihi sÄ±fÄ±rla ve sayfayÄ± yenile
        localStorage.removeItem("aktifTarih");
        location.reload();
    }

    function gecmisiGetir() {
        var gecmis = JSON.parse(localStorage.getItem("diyetGecmisi") || "[]");
        var html = "";
        if(gecmis.length == 0) html = "<div style='color:#777;text-align:center'>HenÃ¼z kayÄ±t yok.</div>";
        
        for(var i=0; i<gecmis.length; i++) {
            html += "<div class='history-item'><span class='history-date'>"+gecmis[i].tarih+"</span>Tamamlanan: "+gecmis[i].ozet+"</div>";
        }
        document.getElementById("gecmisListesi").innerHTML = html;
    }

    function gecmisiTemizle() {
        if(confirm("TÃ¼m geÃ§miÅŸ silinsin mi?")) {
            localStorage.removeItem("diyetGecmisi");
            gecmisiGetir();
        }
    }

    // --- BÄ°LDÄ°RÄ°MLER (Sadece Modern Android Ä°Ã§in) ---
    function bildirimIzniIste() {
        if (!("Notification" in window)) {
            alert("Android 2.3 bu Ã¶zelliÄŸi desteklemiyor. LÃ¼tfen telefonun saat uygulamasÄ±ndan alarm kur.");
        } else {
            Notification.requestPermission().then(function (permission) {
                if (permission === "granted") {
                    new Notification("Harika!", { body: "Bildirimler aÃ§Ä±ldÄ±. Yemek saatlerinde hatÄ±rlatacaÄŸÄ±m." });
                    // Not: Web sayfalarÄ± kapalÄ±yken bildirim atamaz.
                    // Bu yÃ¼zden sadece sayfa aÃ§Ä±kken Ã§alÄ±ÅŸÄ±r.
                }
            });
        }
    }

    window.onload = planOlustur;
</script>

</body>
</html>
