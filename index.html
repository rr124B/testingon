<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Diyet & Spor Koçu</title>
<style>
    /* Android 2.3 Uyumlu CSS */
    body { font-family: sans-serif; background-color: #222; color: #eee; margin: 0; padding: 5px; }
    h1 { font-size: 18px; text-align: center; color: #ff9900; margin-bottom: 5px; }
    button { width: 100%; padding: 10px; margin-bottom: 5px; background: #444; color: #fff; border: 1px solid #666; font-weight: bold; font-size: 16px; border-radius: 5px; }
    button:active { background: #ff9900; color: #000; }
    .tab-btn { width: 32%; display: inline-block; font-size: 14px; padding: 5px; }
    .active-tab { background: #ff9900; color: #000; }
    .content { display: none; background: #333; padding: 10px; border-radius: 5px; margin-top: 5px; }
    .item { border-bottom: 1px solid #555; padding: 8px 0; font-size: 14px; }
    .check-box { display: inline-block; width: 20px; height: 20px; background: #eee; margin-right: 10px; vertical-align: middle; border-radius: 3px; }
    .checked { background: #00cc00; }
    #bildirim { background: #800000; padding: 5px; text-align: center; font-size: 12px; margin-bottom: 5px; display:none;}
    .malzeme-detay { color: #aaa; font-size: 12px; display: block; margin-left: 30px; }
</style>
</head>
<body>

<h1>Kişisel Koç v1.1</h1>

<div style="text-align:center;">
    <button class="tab-btn active-tab" onclick="openTab('diyet')">Diyet</button>
    <button class="tab-btn" onclick="openTab('spor')">Spor</button>
    <button class="tab-btn" onclick="openTab('market')">Market</button>
</div>

<div id="bildirim">Su içmeyi unutma! (3.5 Lt)</div>

<div id="diyet" class="content" style="display:block;">
    <button onclick="yeniGunOlustur()" style="background:#006600;">YENİ GÜN PLANLA</button>
    <div id="gunlukMenu"></div>
</div>

<div id="spor" class="content">
    <h3>Diz Dostu Antrenman</h3>
    <div id="antrenmanListesi"></div>
</div>

<div id="market" class="content">
    <h3>Bugünün Malzemeleri</h3>
    <div id="alisverisListesi"></div>
</div>

<script>
    // GÜNCELLENMİŞ VERİ TABANI (Menü + Malzemeler)
    var kahvaltilar = [
        { ad: "2 Yumurta + Peynir + Zeytin", malz: "2 Yumurta, Beyaz Peynir, 5 Zeytin, Yeşillik, 1 dilim Tam Buğday Ekmek" },
        { ad: "Yoğurt + Yulaf + Elma", malz: "1 kase Yoğurt, Yulaf ezmesi, 1 Elma, Tarçın" },
        { ad: "Menemen + Ekmek", malz: "2 Yumurta, Domates, Biber, 1 dilim Ekmek, Salatalık" }
    ];
    var ogleler = [
        { ad: "Tavuk/Köfte + Bulgur", malz: "150gr Tavuk veya Köfte, Bulgur, Salata Malzemesi" },
        { ad: "Bakliyat Yemeği + Yoğurt", malz: "Kuru Fasulye/Nohut/Mercimek, Yoğurt" },
        { ad: "Ton Balıklı Salata", malz: "1 kutu Ton Balığı, Marul, Roka, Limon" }
    ];
    var ikindiler = [
        { ad: "Sütlü Kahve + Badem", malz: "Süt, Kahve, 10 adet Çiğ Badem" },
        { ad: "Meyve + Kefir", malz: "1 adet Muz/Portakal, 1 şişe Kefir" },
        { ad: "Ceviz + Kuru Kayısı + Çay", malz: "2 tam Ceviz, 2 Kuru Kayısı, Yeşil Çay" }
    ];
    var aksamlar = [
        { ad: "Zeytinyağlı Sebze + Yoğurt", malz: "Mevsim Sebzesi (Pırasa/Ispanak vb.), Zeytinyağı, Yoğurt" },
        { ad: "Çorba + Salata", malz: "Mercimek veya Sebze Çorbası, Peynir, Salata Malzemesi" },
        { ad: "Fırın Tavuk/Balık", malz: "Tavuk veya Balık, Roka, Limon" }
    ];
    
    var serbest = "Acıkırsan: Salatalık, Leblebi veya Sade Soda+Yoğurt";

    var egzersizler = [
        {name: "Oturarak Omuz Press", set: "3x12"},
        {name: "Dambıl Kürek (Sırt)", set: "3x12"},
        {name: "Yerde Göğüs Press", set: "3x15"},
        {name: "Yerde Köprü (Kalça)", set: "3x15"},
        {name: "Koltuk Squat (Yavaş)", set: "3x10"},
        {name: "30 Dk Yürüyüş", set: "Süre"}
    ];

    // Fonksiyonlar
    function openTab(tabName) {
        var i;
        var x = document.getElementsByClassName("content");
        var btn = document.getElementsByClassName("tab-btn");
        for (i = 0; i < x.length; i++) { x[i].style.display = "none"; }
        for (i = 0; i < btn.length; i++) { btn[i].className = "tab-btn"; }
        document.getElementById(tabName).style.display = "block";
        
        if(tabName == 'diyet') btn[0].className += " active-tab";
        if(tabName == 'spor') btn[1].className += " active-tab";
        if(tabName == 'market') btn[2].className += " active-tab";
    }

    function rastgeleSec(dizi) {
        return dizi[Math.floor(Math.random() * dizi.length)];
    }

    function yeniGunOlustur() {
        var plan = {
            k: rastgeleSec(kahvaltilar),
            o: rastgeleSec(ogleler),
            i: rastgeleSec(ikindiler),
            a: rastgeleSec(aksamlar)
        };
        
        if (typeof(Storage) !== "undefined") {
            localStorage.setItem("gunlukPlanObj", JSON.stringify(plan));
            localStorage.setItem("tarih", new Date().toDateString());
        }
        
        ekranaYaz(plan);
        marketListesiOlustur(plan);
        renderSpor();
        alert("Menü güncellendi! Malzemeler listelendi.");
    }

    function ekranaYaz(plan) {
        var html = "";
        html += makeItem("KAHVALTI", plan.k.ad);
        html += makeItem("ÖĞLE", plan.o.ad);
        html += makeItem("İKİNDİ", plan.i.ad);
        html += makeItem("AKŞAM", plan.a.ad);
        html += "<div class='item' style='color:#ff9900'><b>SERBEST:</b> " + serbest + "</div>";
        document.getElementById("gunlukMenu").innerHTML = html;
    }

    function makeItem(baslik, icerik) {
        return "<div class='item' onclick='toggleCheck(this)'>" +
               "<span class='check-box'></span>" +
               "<b>" + baslik + ":</b><br>" + icerik + "</div>";
    }

    function marketListesiOlustur(plan) {
        // ARTIK BURASI MENÜ ADINI DEĞİL, MALZEMELERİ ÇEKİYOR
        var html = "<div class='item' style='color:#ff9900'><i>Eksikleri işaretle:</i></div>";
        
        // Malzemeleri birleştirip alt alta yazdırıyoruz
        html += listeElemani(plan.k.malz);
        html += listeElemani(plan.o.malz);
        html += listeElemani(plan.i.malz);
        html += listeElemani(plan.a.malz);
        
        document.getElementById("alisverisListesi").innerHTML = html;
    }
    
    function listeElemani(text) {
        return "<div class='item' onclick='toggleCheck(this)'>" +
               "<span class='check-box'></span>" + text + "</div>";
    }

    function renderSpor() {
        var html = "";
        for(var i=0; i<egzersizler.length; i++) {
            html += "<div class='item' onclick='toggleCheck(this)'>" + 
                    "<span class='check-box'></span>" +
                    "<b>" + egzersizler[i].name + "</b> (" + egzersizler[i].set + ")</div>";
        }
        document.getElementById("antrenmanListesi").innerHTML = html;
    }

    function toggleCheck(element) {
        var box = element.getElementsByClassName("check-box")[0];
        if(box.className.indexOf("checked") == -1) {
            box.className += " checked";
            element.style.color = "#777"; // İşaretlenince rengi solsun
        } else {
            box.className = box.className.replace(" checked", "");
            element.style.color = "#eee";
        }
    }

    window.onload = function() {
        // Eski kayıt varsa yükle, yoksa yeni oluştur
        if (typeof(Storage) !== "undefined" && localStorage.getItem("gunlukPlanObj")) {
            // NOT: Eski versiyonda "gunlukPlan" kullanıyorduk, çakışmasın diye adını "gunlukPlanObj" yaptım.
            var kayitliPlan = JSON.parse(localStorage.getItem("gunlukPlanObj"));
            ekranaYaz(kayitliPlan);
            marketListesiOlustur(kayitliPlan);
            renderSpor();
            
            var eskiTarih = localStorage.getItem("tarih");
            var bugun = new Date().toDateString();
            if(eskiTarih != bugun) {
                document.getElementById("bildirim").style.display = "block";
                document.getElementById("bildirim").innerHTML = "Yeni bir gün! 'Yeni Gün Planla' butonuna bas.";
            }
        } else {
            yeniGunOlustur();
        }
    };
</script>

</body>
</html>
